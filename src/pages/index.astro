---
import BaseLayout from "@/layout/BaseLayout.astro";
import { Image } from "astro:assets";
import "@/styles/animations.css";
import FullHeight from "@/components/pages/index/FullHeight.astro";
import AnimatedContainer from "@/components/pages/index/AnimatedContainer.astro";
import Timer from "@/components/pages/index/Timer.astro";

import BigBrother from "@/assets/images/big_bro.png";
import Flock from "@/assets/images/flock.png";

import Red from "@/assets/images/red/red_3.png";
import Blues from "@/assets/images/hatchlings/blues.webp";
import Chuck from "@/assets/images/chuck/chuck.webp";
import Matilda from "@/assets/images/matilda.webp";
import Hal from "@/assets/images/hal.webp";
import Bomb from "@/assets/images/bomb/bomb.webp";
import Navigation from "@/components/ui/Navigation.astro";
---

<BaseLayout>
	<main class="overflow-x-hidden">
		<FullHeight>
			<h1
				class="text-5xl sm:text-6xl md:text-7xl lg:text-8xl xl:text-9xl font-angry italic text-center tracking-wider animate-fade-in-up"
				style="animation-delay: 0.2s;"
			>
				Hack The Winter
			</h1>

			<h2
				class="text-4xl sm:text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-angry pb-4 tracking-wider animate-fade-in-up"
				style="animation-delay: 0.6s; opacity: 0;"
			>
				The Second Wave
			</h2>

			<a href="/home/">
				<Image
					loading="eager"
					src={BigBrother}
					alt="Big Brother is Watching You"
					class="w-64 md:w-96 h-auto animate-float"
				/>
			</a>

			<p
				class="animate-fade-in-up"
				style="animation-delay: 1.4s; opacity: 0;"
			>
				(Scroll ↓)
			</p>
		</FullHeight>

		<AnimatedContainer image={Red} align="left">
			<h2
				class="text-8xl md:text-9xl font-angry pb-4 text-center text-red-500"
			>
				24 Hours
			</h2>

			<p
				class="text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-angry text-center"
			>
				National Hackathon
			</p>
		</AnimatedContainer>

		<AnimatedContainer image={Blues} align="right">
			<h2
				class="text-5xl md:text-6xl lg:text-7xl xl:text-8xl font-angry pb-4 text-center text-cyan-500"
			>
				Build The Future 2026
			</h2>

			<p
				class="text-6xl md:text-7xl lg:text-8xl xl:text-9xl font-angry text-center"
			>
				Dec '25 - Jan '26
			</p>
		</AnimatedContainer>

		<AnimatedContainer image={Chuck} align="left">
			<h2
				class="text-6xl sm:text-7xl md:text-8xl lg:text-9xl font-angry pb-4 text-center text-yellow-400"
			>
				Prizes Worth
			</h2>

			<p class="text-7xl md:text-8xl lg:text-9xl font-angry">
				₹ 4,50,000 +
			</p>
		</AnimatedContainer>

		<AnimatedContainer image={Matilda} align="right">
			<h2
				class="text-5xl sm:text-6xl md:text-7xl lg:text-8xl xl:text-9xl font-angry pb-4 text-center text-rose-300"
			>
				Coming Soon
			</h2>

			<Timer />
		</AnimatedContainer>

		<AnimatedContainer image={Hal} align="left">
			<h2
				class="text-5xl sm:text-6xl md:text-7xl lg:text-8xl xl:text-9xl font-angry pb-4 text-center text-green-500"
			>
				Our Sponsors
			</h2>
			<p>Come join hands with us to make this event a grand success!</p>
		</AnimatedContainer>

		<AnimatedContainer image={Bomb} align="right">
			<h2
				class="text-5xl sm:text-6xl md:text-7xl lg:text-8xl xl:text-9xl font-angry pb-4 text-center text-gray-500"
			>
				Organized By
			</h2>
			<p
				class="text-3xl sm:text-4xl md:text-5xl lg:text-6xl xl:text-7xl font-angry text-center"
			>
				{"<WeCode/> GEHU Bhimtal"}
			</p>
		</AnimatedContainer>

		<FullHeight>
			<h2
				class="text-5xl sm:text-6xl md:text-7xl lg:text-8xl xl:text-9xl font-angry italic text-center tracking-wider scroll-animate"
			>
				HACK THE WINTER
			</h2>

			<a href="/home/" class="scroll-animate">
				<Image
					src={Flock}
					alt="Flock"
					class:list={["w-64 md:w-96 lg:w-128 h-auto"]}
				/>
			</a>

			<a
				href="/home/"
				class="mt-8 px-6 py-3 bg-blue-600 text-white text-2xl font-angry rounded-lg hover:bg-blue-700 transition-all duration-300 hover:scale-110 hover:shadow-lg hover:shadow-blue-500/50 scroll-animate animate-pulse-slow"
			>
				Learn More
			</a>
		</FullHeight>
	</main>

	<!-- Invisible navigation to preload videos -->
	<Navigation class="hidden" />
</BaseLayout>

<script>
	// Scroll animations
	function initScrollAnimations() {
		const observerOptions = {
			threshold: 0.1,
			rootMargin: "0px 0px -50px 0px",
		};

		const observer = new IntersectionObserver((entries) => {
			entries.forEach((entry) => {
				if (entry.isIntersecting) {
					entry.target.classList.add("animate");
				}
			});
		}, observerOptions);

		// Observe all scroll-animate elements
		document
			.querySelectorAll(
				".scroll-animate, .scroll-animate-left, .scroll-animate-right",
			)
			.forEach((el) => {
				observer.observe(el);
			});
	}

	// Countdown timer
	function initCountdown() {
		// Set target date (example: December 25, 2025)
		const targetDate = new Date("2025-12-20T00:00:00").getTime();

		function updateCountdown() {
			const now = new Date().getTime();
			const distance = targetDate - now;

			if (distance > 0) {
				const days = Math.floor(distance / (1000 * 60 * 60 * 24));
				const hours = Math.floor(
					(distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60),
				);
				const minutes = Math.floor(
					(distance % (1000 * 60 * 60)) / (1000 * 60),
				);
				const seconds = Math.floor((distance % (1000 * 60)) / 1000);

				const daysEl = document.getElementById("days");
				const hoursEl = document.getElementById("hours");
				const minutesEl = document.getElementById("minutes");
				const secondsEl = document.getElementById("seconds");

				if (daysEl)
					daysEl.textContent = days.toString().padStart(2, "0");
				if (hoursEl)
					hoursEl.textContent = hours.toString().padStart(2, "0");
				if (minutesEl)
					minutesEl.textContent = minutes.toString().padStart(2, "0");
				if (secondsEl)
					secondsEl.textContent = seconds.toString().padStart(2, "0");
			}
		}

		updateCountdown();
		setInterval(updateCountdown, 1000);
	}

	// Parallax effect for floating elements
	function initParallax() {
		window.addEventListener("scroll", () => {
			const scrolled = window.pageYOffset;
			const parallaxElements =
				document.querySelectorAll(".animate-float");

			parallaxElements.forEach((element) => {
				const speed = 0.5;
				const yPos = -(scrolled * speed);
				element.style.transform = `translateY(${yPos}px)`;
			});
		});
	}

	// Function to initialize all animations
	function initializeAll() {
		// Reset any existing animations first
		document
			.querySelectorAll(
				".scroll-animate, .scroll-animate-left, .scroll-animate-right",
			)
			.forEach((el) => {
				el.classList.remove("animate");
			});

		// Initialize animations
		initScrollAnimations();
		initCountdown();
		initParallax();

		// Add smooth scrolling for anchor links
		document.querySelectorAll('a[href^="#"]').forEach((anchor) => {
			anchor.addEventListener("click", function (e) {
				e.preventDefault();
				const target = document.querySelector(
					this.getAttribute("href"),
				);
				if (target) {
					target.scrollIntoView({
						behavior: "smooth",
						block: "start",
					});
				}
			});
		});
	}

	// Initialize on DOM ready
	document.addEventListener("DOMContentLoaded", initializeAll);

	// Re-initialize on Astro page transitions
	document.addEventListener("astro:page-load", initializeAll);

	// Also handle the case where script runs after DOM is already loaded
	if (document.readyState !== "loading") {
		initializeAll();
	}
</script>
